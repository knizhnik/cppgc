<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CppGC: GC::MemoryAllocator Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">CppGC
   &#160;<span id="projectnumber">1.01</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>GC</b>      </li>
      <li class="navelem"><a class="el" href="classGC_1_1MemoryAllocator.html">MemoryAllocator</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">GC::MemoryAllocator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="GC::MemoryAllocator" -->
<p><code>#include &lt;<a class="el" href="gc_8h_source.html">gc.h</a>&gt;</code></p>

<p><a href="classGC_1_1MemoryAllocator-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a78e0904f98fc08efcc684aff38a420d7">MemoryAllocator</a> (size_t gcStartThreshold=1024 *1024, size_t gcAutoStartThreshold=(size_t)-1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a9f62e62cfc72cfb2d85d37c040a7ad26">~MemoryAllocator</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab7e4057c376d6388333a2fd263a901fe"></a><!-- doxytag: member="GC::MemoryAllocator::_registerRoot" ref="ab7e4057c376d6388333a2fd263a901fe" args="(Root *root)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_registerRoot</b> (<a class="el" href="classGC_1_1Root.html">Root</a> *root)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aea4f0ab65f03ae33077fb3e37cf68af7"></a><!-- doxytag: member="GC::MemoryAllocator::_unregisterRoot" ref="aea4f0ab65f03ae33077fb3e37cf68af7" args="(Root *root)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_unregisterRoot</b> (<a class="el" href="classGC_1_1Root.html">Root</a> *root)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c940f1da5106bf4415cc2a3bb6eff84"></a><!-- doxytag: member="GC::MemoryAllocator::_mark" ref="a7c940f1da5106bf4415cc2a3bb6eff84" args="(Object *obj)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_mark</b> (<a class="el" href="classGC_1_1Object.html">Object</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a83ec7b438178598e493595d7552b8362"></a><!-- doxytag: member="GC::MemoryAllocator::_mark" ref="a83ec7b438178598e493595d7552b8362" args="(Object **refs, size_t nRefs)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_mark</b> (<a class="el" href="classGC_1_1Object.html">Object</a> **refs, size_t nRefs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4096d28fbc93d651040f187792c57271"></a><!-- doxytag: member="GC::MemoryAllocator::_allocate" ref="a4096d28fbc93d651040f187792c57271" args="(size_t size)" -->
void *&#160;</td><td class="memItemRight" valign="bottom"><b>_allocate</b> (size_t size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a318a05c79836ca4f495e95fbd5f3ac2d"></a><!-- doxytag: member="GC::MemoryAllocator::_gc" ref="a318a05c79836ca4f495e95fbd5f3ac2d" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_gc</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a98de9d4952cbabc218592b1ce8476499"></a><!-- doxytag: member="GC::MemoryAllocator::_allowGC" ref="a98de9d4952cbabc218592b1ce8476499" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_allowGC</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1642017faca83dd7faa76d10c4bd34e9"></a><!-- doxytag: member="GC::MemoryAllocator::_visit" ref="a1642017faca83dd7faa76d10c4bd34e9" args="(AnyWeakRef *wref)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>_visit</b> (<a class="el" href="classGC_1_1AnyWeakRef.html">AnyWeakRef</a> *wref)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classGC_1_1MemoryAllocator.html">MemoryAllocator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a3d3061ec3d80a6fea0dc1a261bbeaf0f">getCurrent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a7d92e131ec91a1d9b8451b8aa36b4b18">allocate</a> (size_t size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a80e339bd08a6c99b79b10faccb1db790">mark</a> (<a class="el" href="classGC_1_1Object.html">Object</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a5cf7971149402426e88df6ee1bcc744a">mark</a> (<a class="el" href="classGC_1_1Object.html">Object</a> **refs, size_t nRefs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a2fdfc6a6d99debb107a577bfd0cb4b4d">visit</a> (<a class="el" href="classGC_1_1AnyWeakRef.html">AnyWeakRef</a> *wref)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#ac59febdb842cfb3cf74218de723bdd73">registerRoot</a> (<a class="el" href="classGC_1_1Root.html">Root</a> *root)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a0a8799f8a630efc4cc4dc1be22da005e">unregisterRoot</a> (<a class="el" href="classGC_1_1Root.html">Root</a> *root)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#a020bb1cb28853a3aaf2c7e844c19fb5b">gc</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGC_1_1MemoryAllocator.html#ad588fbbad09bb17662a3f3a0adfd3a88">allowGC</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0720b5f434e636e22a3ed34f847eec57"></a><!-- doxytag: member="GC::MemoryAllocator::Object" ref="a0720b5f434e636e22a3ed34f847eec57" args="" -->
class&#160;</td><td class="memItemRight" valign="bottom"><b>Object</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Memory allocator class with implicit memory deallocation (garbage collector). Each thread should have its own allocator. So each thread is allocating and deallocating only its own objects. But it is possible to refer object created by some global allocator, taken in account that this objects will not be protected from GC. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a78e0904f98fc08efcc684aff38a420d7"></a><!-- doxytag: member="GC::MemoryAllocator::MemoryAllocator" ref="a78e0904f98fc08efcc684aff38a420d7" args="(size_t gcStartThreshold=1024 *1024, size_t gcAutoStartThreshold=(size_t)&#45;1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGC_1_1MemoryAllocator.html#a78e0904f98fc08efcc684aff38a420d7">GC::MemoryAllocator::MemoryAllocator</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>gcStartThreshold</em> = <code>1024&#160;*1024</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>gcAutoStartThreshold</em> = <code>(size_t)-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create instance of memory allocator </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">gcStartThreshold</td><td>total size of objects allocated since last GC after which <a class="el" href="classGC_1_1MemoryAllocator.html#ad588fbbad09bb17662a3f3a0adfd3a88">allowGC()</a> method initiates garbage collection </td></tr>
    <tr><td class="paramname">gcAutoStartThreshold</td><td>total size of objects allocated since last GC after which garbage collection is automatically started. Please notice that all used objects should be protected from GC in this case by registering their roots. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9f62e62cfc72cfb2d85d37c040a7ad26"></a><!-- doxytag: member="GC::MemoryAllocator::~MemoryAllocator" ref="a9f62e62cfc72cfb2d85d37c040a7ad26" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGC_1_1MemoryAllocator.html#a9f62e62cfc72cfb2d85d37c040a7ad26">GC::MemoryAllocator::~MemoryAllocator</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Deallocate all objects create by GC. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a7d92e131ec91a1d9b8451b8aa36b4b18"></a><!-- doxytag: member="GC::MemoryAllocator::allocate" ref="a7d92e131ec91a1d9b8451b8aa36b4b18" args="(size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void* <a class="el" href="classGC_1_1MemoryAllocator.html#a7d92e131ec91a1d9b8451b8aa36b4b18">GC::MemoryAllocator::allocate</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Allocate object </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">object</td><td>size </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="classGC_1_1Object.html#a708211af5a07809ad98678179cd6ab96">GC::Object::operator new()</a>.</p>

</div>
</div>
<a class="anchor" id="ad588fbbad09bb17662a3f3a0adfd3a88"></a><!-- doxytag: member="GC::MemoryAllocator::allowGC" ref="ad588fbbad09bb17662a3f3a0adfd3a88" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#ad588fbbad09bb17662a3f3a0adfd3a88">GC::MemoryAllocator::allowGC</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Start garbage collection if number of allocated objects since last GC exceeds StartThreshold </p>

</div>
</div>
<a class="anchor" id="a020bb1cb28853a3aaf2c7e844c19fb5b"></a><!-- doxytag: member="GC::MemoryAllocator::gc" ref="a020bb1cb28853a3aaf2c7e844c19fb5b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#a020bb1cb28853a3aaf2c7e844c19fb5b">GC::MemoryAllocator::gc</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Explicitly starts garbage collection. </p>

</div>
</div>
<a class="anchor" id="a3d3061ec3d80a6fea0dc1a261bbeaf0f"></a><!-- doxytag: member="GC::MemoryAllocator::getCurrent" ref="a3d3061ec3d80a6fea0dc1a261bbeaf0f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classGC_1_1MemoryAllocator.html">MemoryAllocator</a>* <a class="el" href="classGC_1_1MemoryAllocator.html#a3d3061ec3d80a6fea0dc1a261bbeaf0f">GC::MemoryAllocator::getCurrent</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get allocator for the current thread. Each thread should have its own allocator. </p>

</div>
</div>
<a class="anchor" id="a80e339bd08a6c99b79b10faccb1db790"></a><!-- doxytag: member="GC::MemoryAllocator::mark" ref="a80e339bd08a6c99b79b10faccb1db790" args="(Object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#a80e339bd08a6c99b79b10faccb1db790">GC::MemoryAllocator::mark</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGC_1_1Object.html">Object</a> *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mark object as reachable and recursively mark all references objects </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">obj</td><td>marked objects (may be NULL) </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="classGC_1_1Ref.html#a49ed6e9586a53cb088e972dc43f07256">GC::Ref&lt; ObjectArray&lt; T &gt; &gt;::Ref()</a>.</p>

</div>
</div>
<a class="anchor" id="a5cf7971149402426e88df6ee1bcc744a"></a><!-- doxytag: member="GC::MemoryAllocator::mark" ref="a5cf7971149402426e88df6ee1bcc744a" args="(Object **refs, size_t nRefs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#a80e339bd08a6c99b79b10faccb1db790">GC::MemoryAllocator::mark</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGC_1_1Object.html">Object</a> **&#160;</td>
          <td class="paramname"><em>refs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nRefs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mark array of objects. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refs</td><td>pointer to array of references </td></tr>
    <tr><td class="paramname">nRefs</td><td>number of references </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac59febdb842cfb3cf74218de723bdd73"></a><!-- doxytag: member="GC::MemoryAllocator::registerRoot" ref="ac59febdb842cfb3cf74218de723bdd73" args="(Root *root)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#ac59febdb842cfb3cf74218de723bdd73">GC::MemoryAllocator::registerRoot</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGC_1_1Root.html">Root</a> *&#160;</td>
          <td class="paramname"><em>root</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Register root object. Registering root protects it and all referenced objects from GC. </p>

<p>Referenced by <a class="el" href="classGC_1_1Root.html#a646d07ea6c313208649641e67d7fe5e6">GC::Root::Root()</a>.</p>

</div>
</div>
<a class="anchor" id="a0a8799f8a630efc4cc4dc1be22da005e"></a><!-- doxytag: member="GC::MemoryAllocator::unregisterRoot" ref="a0a8799f8a630efc4cc4dc1be22da005e" args="(Root *root)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#a0a8799f8a630efc4cc4dc1be22da005e">GC::MemoryAllocator::unregisterRoot</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGC_1_1Root.html">Root</a> *&#160;</td>
          <td class="paramname"><em>root</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Unregister root object. Make this object tree available for GC. </p>

<p>Referenced by <a class="el" href="classGC_1_1Root.html#a74a192f3956c6b2138ce54a3931085ae">GC::Root::~Root()</a>.</p>

</div>
</div>
<a class="anchor" id="a2fdfc6a6d99debb107a577bfd0cb4b4d"></a><!-- doxytag: member="GC::MemoryAllocator::visit" ref="a2fdfc6a6d99debb107a577bfd0cb4b4d" args="(AnyWeakRef *wref)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classGC_1_1MemoryAllocator.html#a2fdfc6a6d99debb107a577bfd0cb4b4d">GC::MemoryAllocator::visit</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGC_1_1AnyWeakRef.html">AnyWeakRef</a> *&#160;</td>
          <td class="paramname"><em>wref</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Visit weak reference. Garbage collector links all weak references in list and after mark phase reset those of them non pointing to live objects. Weak referenced objects are not traversed by GC. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">wref</td><td>weak reference </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="gc_8h_source.html">gc.h</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 1 2014 12:56:15 for CppGC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
